---
import type { DropdownLinkStoryblok } from "@storyblok/types";
import { parseLink } from "@/services/storyblok/utils/parse-link";
import type { Prettify } from "@/types";
import { storyblokEditable, type SbBlokData } from "@storyblok/astro";
import { cva, type VariantProps } from "class-variance-authority";
import { cn } from "@/utils/cn";
import BodyText from "@/components/ui/body-text.astro";
import Label from "@/components/ui/label.astro";

type LinkStyle = "primary" | "ghost" | "standard";

export const linkVariants = cva(
  "font-sans font-medium rounded-md transition-colors duration-200 ease-in-out",
  {
    variants: {
      style: {
        primary: "bg-accent-electric text-text-000 px-6 py-3 hover:bg-blue-700",
        ghost: "text-text-000 hover:text-text-200",
        standard: "text-text-000 underline hover:text-text-200",
      } as Record<LinkStyle, string>, // Ensure keys are of type LinkStyle
    },
    defaultVariants: {
      style: "standard" as LinkStyle, // Ensure default is of type LinkStyle
    },
  },
);

export interface Props extends VariantProps<typeof linkVariants> {
  blok: Prettify<DropdownLinkStoryblok>;
  style?: LinkStyle; // Use the defined LinkStyle type for the prop
}

const {
  blok: { link, linkText, linkDescription },
  style: variantStyleProp, // Renamed to avoid confusion with CVA's 'style' variant
  ...attrs
} = Astro.props;

const variantClasses = linkVariants({ style: variantStyleProp });
const finalClasses = cn(variantClasses);
---

<a
  href={parseLink(link, "href")}
  target={parseLink(link, "target")}
  class={finalClasses}
  {...storyblokEditable(Astro.props.blok as SbBlokData)}
  {...attrs}
>
  <Label size="m" weight="medium">{linkText}</Label>
  <BodyText size="s">{linkDescription}</BodyText>
</a>
